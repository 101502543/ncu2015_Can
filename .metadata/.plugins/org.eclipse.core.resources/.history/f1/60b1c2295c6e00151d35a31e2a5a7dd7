//FreeGeng 2015/10/9
import java.io.*;
import java.net.*;

public class UDP_client extends Thread {

	int port; // port 
	InetAddress serverAddress; // represent server's ip address
	String msg; // represent the message which we want to send

	public static void main(String args[]) throws Exception {
		for (int i = 0; i < 100; i++) {
			// bulid the client，set the server and message
			UDP_client client = new UDP_client(args[0], 8888, "UdpClient : " + i
					+ "th message");
			client.run(); // 啟動 UdpClient 開始傳送。
		}
	}

	public UDP_client(String openServer, int openPortNum, String sendMsg) throws Exception {
		port = openPortNum; // set the port
		serverAddress= InetAddress.getByName(openServer); // transfer the address to ip
		msg = sendMsg; // set the message which we want to send
	}

	public void run() {
		try {
			byte buffer[] = msg.getBytes(); // transfer msg to byte 
			// build the packet to DatagramPacket
			//set the destination
			DatagramPacket packet = new DatagramPacket(buffer, buffer.length,
					serverAddress, port);
			DatagramSocket socket = new DatagramSocket(); // build the server
			socket.send(packet); 
			socket.close(); 
		} catch (Exception e) {
			e.printStackTrace();
		} 
	}

}
